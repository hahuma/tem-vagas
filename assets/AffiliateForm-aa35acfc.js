import{h as A,u as E,b as k,f as p,i as F}from"./axios-23462d7f.js";import{u as U,_ as D}from"./Person-975cfcfc.js";import{d as N}from"./pinia-a5bbb7e4.js";import{u as $}from"./formStore-2556024b.js";import{_ as B}from"./ShowErrors-70f32166.js";import{Y as _,aa as M,ae as P,b as T,o as c,c as f,e,a as w,w as u,S as t,k as b,F as z}from"./runtime-core.esm-bundler-5fc0a256.js";import"./lodash-9f8c5478.js";const O=N("affiliateStore",{state:()=>({data:{affiliate:{person_contact:"",email_billing:"",phone_billing:"",note:"",active:!0}}})}),R={class:"page-content"},j={class:"container-fluid"},Y={class:"row"},q={class:"col-xl-8"},G={class:"card"},H={class:"card-body"},J=e("h4",{class:"card-title mb-3"},"Cadastro de Afiliados",-1),K=e("hr",null,null,-1),L=e("h3",null,"Informações para recebimento de comissões",-1),Q=e("hr",null,null,-1),W={class:"col-6"},X=e("label",{for:"person_contact",class:"form-label"},"Pessoa de contato",-1),Z=["disabled"],ee={class:"col-6"},ae=e("label",{for:"email_billing",class:"form-label"},"Email",-1),te=["disabled"],oe={class:"col-3"},se=e("label",{for:"phone_billing",class:"form-label"},"Telefone",-1),ie=["disabled"],le={key:0,class:"col-6"},ne=e("label",{for:"note",class:"form-label"},"Observações",-1),re=["disabled"],de={key:1,class:"col-3"},ce={class:"form-check"},fe=["disabled"],ue=e("label",{class:"form-check-label",for:"active"},"Ativo",-1),me={key:0,class:"d-flex my-4 justify-content-center w-100"},pe=["disabled"],_e={key:0},Se={__name:"AffiliateForm",setup(be){const x="/affiliates",h=_(""),m=_(!1),v=_(!1);let r=_([]);const o=$(),s=U(),a=O(),g=A(),y=E(),S=()=>{switch(o.action){case"insert":case"edit":y.push({path:"/admin/afiliados"});break}o.editing=!1},I=async()=>{if(V())return;s.data={...s.data,person:{...s.data.person,document:d(s.data.person.document),zip_code:d(s.data.person.zip_code),phone:d(s.data.person.phone),whatsapp:d(s.data.person.whatsapp)}},a.data={...a.data,affiliate:{...a.data.affiliate,phone_billing:d(a.data.affiliate.phone_billing)}};const{data:l}=await k.post(x,{person:s.data.person,user:s.data.user,affiliate:a.data.affiliate});l.error?(r.value=l.message,m.value=!0,v.value=!1,o.editing=!0):(o.editing=!1,y.push({path:"/admin/afiliados"}))},d=l=>typeof l=="string"?replace(/[^0-9]/g,"").replace(/\D/g,""):l,V=()=>(r.value=s.hasErrorForm(),a.data.affiliate.person_contact===""&&r.value.push("Informe o nome da pessoa de contato"),a.data.affiliate.email_billing===""?r.value.push("Informe o email de faturamento"):/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2,3})+$/.test(a.data.affiliate.email_billing)||r.value.push("Informe um email de faturamento válido"),a.data.affiliate.phone===""&&r.value.push("Informe o telefone contato"),r.value.length?(m.value=!0,!0):!1);return M(async()=>{if(!g.params.id)o.action="insert",o.editing=!0;else{o.editing=!0,o.action="edit";const l=await s.searchAffiliateByID(g.params.id);a.data.affiliate=l.affiliate}await k.get("/affiliates/small-selects").then(({data:l})=>{s.miniSelects=l}),h.value=localStorage.getItem("profile")}),P(()=>{s.editing=!1,s.$reset()}),(l,i)=>{const C=T("mask");return c(),f(z,null,[e("div",R,[e("div",j,[e("div",Y,[e("div",q,[e("div",G,[e("div",H,[J,w(D,{"type-perfil":"affiliate","type-person":""}),K,L,Q,e("div",null,[e("div",W,[X,u(e("input",{id:"person_contact","onUpdate:modelValue":i[0]||(i[0]=n=>t(a).data.affiliate.person_contact=n),type:"text",autocomplete:"off",class:"form-control border-gray-500",disabled:!t(o).editing},null,8,Z),[[p,t(a).data.affiliate.person_contact]])]),e("div",ee,[ae,u(e("input",{id:"email_billing","onUpdate:modelValue":i[1]||(i[1]=n=>t(a).data.affiliate.email_billing=n),type:"email",autocomplete:"off",class:"form-control border-gray-500",style:{"text-transform":"lowercase"},disabled:!t(o).editing},null,8,te),[[p,t(a).data.affiliate.email_billing]])]),e("div",oe,[se,u(e("input",{id:"phone_billing","onUpdate:modelValue":i[2]||(i[2]=n=>t(a).data.affiliate.phone_billing=n),type:"text",class:"form-control border-gray-500",disabled:!t(o).editing},null,8,ie),[[p,t(a).data.affiliate.phone_billing],[C,["(##) ####-####","(##) #####-####"]]])]),h.value=="admin"?(c(),f("div",le,[ne,u(e("input",{id:"note","onUpdate:modelValue":i[3]||(i[3]=n=>t(a).data.affiliate.note=n),type:"text",class:"form-control border-gray-500",disabled:!t(o).editing},null,8,re),[[p,t(a).data.affiliate.note]])])):b("",!0),h.value=="admin"?(c(),f("div",de,[e("div",ce,[u(e("input",{id:"active","onUpdate:modelValue":i[4]||(i[4]=n=>t(a).data.affiliate.active=n),class:"form-check-input",type:"checkbox","true-value":"true",disabled:!t(o).editing,"false-value":"false"},null,8,fe),[[F,t(a).data.affiliate.active]]),ue])])):b("",!0)]),t(o).editing?(c(),f("div",me,[e("button",{class:"btn btn-outline-gray-800 fs-5 py-1 px-4 border-0 me-2",onClick:S},"Cancelar"),e("button",{type:"submit",disabled:v.value,form:"register-balanco-form",class:"btn btn-warning bg-orange fs-5 py-1 px-4 border-0",onClick:I}," Salvar ",8,pe)])):b("",!0)])])])])])]),m.value?(c(),f("div",_e,[w(B,{errors:t(r),onClick:i[5]||(i[5]=n=>m.value=!1)},null,8,["errors"])])):b("",!0)],64)}}};export{Se as default};

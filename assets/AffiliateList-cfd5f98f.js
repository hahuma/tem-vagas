import{u as B,b as w,v as D}from"./axios-23462d7f.js";import{_ as x}from"./lodash-9f8c5478.js";import{_ as M}from"./Card-36b4d3b5.js";import{_ as L,a as P,b as T}from"./NextPage-40bb9e0e.js";import{_ as J}from"./Modal-20c18eb7.js";import{Y as i,Z as j,aa as q,r as z,o as l,c as n,e as a,a as d,S as _,i as E,F as k,f as O,p,w as R,t as v,h as U}from"./runtime-core.esm-bundler-5fc0a256.js";const Y={class:"page-content"},Z={class:"container-fluid"},G={key:1},H={class:"row row-cols-1 row-cols-md-2 row-cols-lg-2 g-4"},I=a("h2",{class:"h4 modal-title"},"Filtro de busca",-1),K={class:"modal-body"},Q={id:"advanced-search-form"},W={class:"row mb-1"},X=a("label",{class:"form-label pb-1 fs-6 fw-400",for:"city_id"},"Município",-1),ee={class:"d-flex justify-content-between align-items-center"},se={class:"d-flex flex-column"},ae={key:1,style:{opacity:"0.5"}},de={__name:"AffiliateList",setup(te){const C=s=>({header:{[s.type_person_id==="J"?"CNPJ":"CPF"]:s.document_number,status:s.status},body:{Nome:s.name,Apelido:s.short_name},footer:{Município:s.city}}),h=B(),m=i(""),b=i([]),u=i([]),y=i(1),N=i(0),S=i(!1),o=i({search:"",city_id:"",page_size:50,page_start:1}),$=s=>{h.push({path:"/admin/afiliado/"+s})};j(m,s=>{V(s)});const V=x.debounce((s,e)=>{o.value.search=s,f(!1)},750),A=()=>{o.value=filters.value},f=async(s=!1)=>{filters.value=o.value;try{const{data:e}=await w.get("/affiliates/list",{params:o.value});e.affiliates.length&&(s?u.value.push(...e.affiliates):u.value=e.affiliates,N.value=e.records,y.value=e.pages)}catch{}};async function F(){o.value.page_start++,f(!0)}const g=x.debounce((s,e)=>{!s||w.get(`/cities/${s}`).then(({data:c})=>b.value=c.cities).catch(c=>console.log(c)).finally(()=>e&&e(!1))},750);return q(async()=>{f()}),(s,e)=>{const c=z("v-select");return l(),n("div",Y,[a("div",Z,[d(L,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),title:"Lista de Afiliados",onAction:e[1]||(e[1]=()=>_(h).push("/admin/afiliado"))},null,8,["modelValue"]),u.value.length==0&&!S.value?(l(),E(T,{key:0,text:"Nenhum afiliado encontrado"})):(l(),n("div",G,[a("div",H,[(l(!0),n(k,null,O(u.value,t=>(l(),n("div",{key:t.uuid,class:"col"},[d(M,{id:t.uuid,content:C(t),onAction:e[2]||(e[2]=r=>$(r))},null,8,["id","content"])]))),128))])])),d(J,{id:"advanced-search","class-name":"modal-dialog w-100 ms-auto mt-6 me-4 d-flex flex-column"},{default:p(()=>[a("div",{class:"modal-header border-0 pb-0"},[I,a("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close","aria-hidden":"true",onClick:A})]),a("div",K,[a("div",Q,[a("div",W,[X,d(c,{id:"city_id",class:"style-chooser",label:"name",reduce:t=>t.name,options:b.value,"clear-search-on-select":!0,filterable:!1,clearable:!0,onSearch:_(g),"onOption:selected":e[3]||(e[3]=t=>o.value.city_id=t.id),"onSearch:focus":e[4]||(e[4]=t=>_(g)())},{option:p(({name:t,initials:r})=>[a("div",ee,[a("div",se,[a("span",null,v(t),1),a("span",null,v(r),1)])])]),"no-options":p(({search:t,searching:r})=>[r?(l(),n(k,{key:0},[U(" Não encontrado "),a("em",null,v(t),1)],64)):(l(),n("em",ae,"Digite as iniciais do nome"))]),_:1},8,["reduce","options","onSearch"])])])]),a("div",{class:"modal-footer border-0"},[a("button",{type:"submit",form:"advanced-search-form","aria-label":"Close","aria-hidden":"true","data-bs-dismiss":"modal",class:"btn w-100 bg-orange fs-4 py-1 px-4 border-0",onClick:f}," Pesquisar ")])]),_:1}),R(a("div",null,[d(P,{onClick:F})],512),[[D,o.value.page_start<y.value]])])])}}};export{de as default};

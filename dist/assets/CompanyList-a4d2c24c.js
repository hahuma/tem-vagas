import{u as M,b as x,v as B,w as D}from"./axios-23462d7f.js";import{_ as A}from"./lodash-9f8c5478.js";import{_ as L}from"./Card-36b4d3b5.js";import{_ as P,a as E,b as J}from"./NextPage-40bb9e0e.js";import{_ as T}from"./Modal-20c18eb7.js";import{Y as n,Z as j,aa as q,r as z,o as l,c as i,e as s,a as u,S as p,i as O,F as _,f as R,p as h,w as U,t as b,h as Y}from"./runtime-core.esm-bundler-5fc0a256.js";const Z={class:"page-content"},G={class:"container-fluid"},H={key:1,class:"h-100 p-4 overflow-overlay page-app"},I={class:"row row-cols-1 row-cols-md-2 row-cols-lg-2 g-4"},K=s("h2",{class:"h4 modal-title"},"Filtro de busca",-1),Q={class:"modal-body"},W={class:"row mb-1"},X=s("label",{class:"form-label pb-1 fs-6 fw-400",for:"city_id"},"Município",-1),ee={class:"d-flex justify-content-between align-items-center"},se={class:"d-flex flex-column"},ae={key:1,style:{opacity:"0.5"}},oe={class:"modal-footer border-0"},ue={__name:"CompanyList",setup(te){const $=a=>({header:{[a.type_person_id==="J"?"CNPJ":"CPF"]:a.document_number,status:a.status},body:{Nome:a.name,Apelido:a.short_name},footer:{Município:a.city}}),y=M(),f=n("");let g=n([]);const v=n(!0),m=n([]),w=n(1),S=n(0),t=n({city_id:"",page_size:50,page_start:1}),C=n({});j(f,a=>{a&&(t.value.search=a,r())});const N=()=>{t.value=C.value},r=async(a=!1)=>{C.value=t.value,v.value=!1;const{data:e}=await x.get("/companies/list",{params:t.value});e.error||(a?m.value.push(...e.companies):m.value=e.companies,S.value=e.records,w.value=e.pages),v.value=!1},V=a=>{y.push({path:"/admin/empresa/"+a})};async function F(){t.value.page_start++,r(!0)}const k=A.debounce((a,e)=>{!a||x.get(`/cities/${a}`).then(({data:c})=>g=c.cities).catch(c=>console.log(c)).finally(()=>e&&e(!1))},500);return q(async()=>{r()}),(a,e)=>{const c=z("v-select");return l(),i(_,null,[s("div",Z,[s("div",G,[u(P,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=o=>f.value=o),title:"Lista de Empresas",onAction:e[1]||(e[1]=()=>p(y).push("/admin/empresa"))},null,8,["modelValue"]),m.value.length==0&&!v.value?(l(),O(J,{key:0,text:"Nenhuma empresa encontrada"})):(l(),i("div",H,[s("div",I,[(l(!0),i(_,null,R(m.value,o=>(l(),i("div",{key:o.uuid,class:"col"},[u(L,{id:o.uuid,content:$(o),onAction:e[2]||(e[2]=d=>V(d))},null,8,["id","content"])]))),128))])]))])]),u(T,{id:"advanced-search","class-name":"modal-dialog w-100 ms-auto mt-6 me-4 d-flex flex-column"},{default:h(()=>[s("div",{class:"modal-header border-0 pb-0"},[K,s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close","aria-hidden":"true",onClick:N})]),s("div",Q,[s("div",{id:"advanced-search-form",onSubmit:e[5]||(e[5]=D(o=>r(t.value),["prevent"]))},[s("div",W,[X,u(c,{id:"city_id",class:"style-chooser",label:"name",reduce:o=>o.name,options:p(g),"clear-search-on-select":!0,filterable:!1,clearable:!0,onSearch:p(k),"onOption:selected":e[3]||(e[3]=o=>t.value.city_id=o.id),"onSearch:focus":e[4]||(e[4]=o=>p(k)())},{option:h(({name:o,initials:d})=>[s("div",ee,[s("div",se,[s("span",null,b(o),1),s("span",null,b(d),1)])])]),"no-options":h(({search:o,searching:d})=>[d?(l(),i(_,{key:0},[Y(" Não encontrado "),s("em",null,b(o),1)],64)):(l(),i("em",ae,"Digite as iniciais do nome"))]),_:1},8,["reduce","options","onSearch"])])],32)]),s("div",oe,[s("button",{type:"submit",form:"advanced-search-form","aria-label":"Close","aria-hidden":"true","data-bs-dismiss":"modal",class:"btn w-100 bg-orange fs-4 py-1 px-4 border-0",onClick:e[6]||(e[6]=o=>r())}," Pesquisar ")])]),_:1}),U(s("div",null,[u(E,{onClick:F})],512),[[B,t.value.page_start<w.value]])],64)}}};export{ue as default};
